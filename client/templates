<!DOCTYPE html>
<html>
<head>
    <title>1v1 Chat</title>
</head>
<body>

<h1>1v1 Chat</h1>

<button id="findBtn">Find Partner</button>

<div id="chat" style="display:none;">
    <h2>Connected!</h2>
    <div id="messages" style="border:1px solid #000; height:200px; overflow:auto;"></div>
    <input id="msg" type="text"><button id="sendBtn">Send</button>
</div>

<script src="https://cdn.socket.io/4.4.1/socket.io.min.js"></script>
<script>
const socket = io("http://localhost:5500"); // Port من السيرفر
let room = null;

// Start matchmaking
document.getElementById("findBtn").onclick = () => {
    socket.emit("join");
    alert("Looking for a partner...");
};

// Matched event
socket.on("matched", data => {
    room = data.room;
    document.getElementById("chat").style.display = "block";
    alert("Partner found!");
});

// Send chat message
document.getElementById("sendBtn").onclick = () => {
    const m = document.getElementById("msg").value;
    if(m && room){
        socket.emit("chat_message", { message: m });
        document.getElementById("messages").innerHTML += `<p><b>You:</b> ${m}</p>`;
        document.getElementById("msg").value = '';
    }
};

// Receive chat message
socket.on("chat_message", data => {
    document.getElementById("messages").innerHTML += `<p><b>Partner:</b> ${data.message}</p>`;
});
</script>

</body>
</html>
